@model Weblog.Core.Domain.Entities.Post

@{
    ViewData["Title"] = Model.Title;
}

<div class="container">
    <!-- Post Content -->
    <div class="post-card">
        <h1>@Model.Title</h1>
        <p>@Model.Content</p>
        <p><small>Author: @Model.AuthorName | Published on: @Model.CreatedDate.ToShortDateString()</small></p>
    </div>

    <hr />

    <!-- Comments Section -->
    <h3>Comments</h3>
    @if (Model.Comments != null && Model.Comments.Any(c => c.IsApproved))
    {
        foreach (var comment in Model.Comments.Where(c => c.IsApproved))
        {
            <div class="comment-card">
                <p>@comment.Text</p>
                <p><small>User: @comment.UserId | Posted on: @comment.CreatedDate</small></p>
            </div>
        }
    }
    else
    {
        <p>No comments yet. Be the first to comment!</p>
    }

    <!-- Add Comment Form -->
    @if (User.Identity.IsAuthenticated)
    {
        <hr />
        <h4>Leave a Comment</h4>
        <form asp-controller="Post" asp-action="AddComment" method="post">
            <input type="hidden" name="postId" value="@Model.Id" />
            <textarea name="content" class="form-control" rows="4" placeholder="Write your comment here..."></textarea><br />
            <button type="submit" class="btn">Submit Comment</button>
        </form>
    }
    else
    {
        <p><a asp-controller="Account" asp-action="Login">Log in</a> to leave a comment.</p>
    }
</div>
